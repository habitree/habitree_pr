# Habitree 기능명세서 (Functional Specification)

## 📋 문서 정보

| 항목 | 내용 |
|------|------|
| **프로젝트명** | Habitree |
| **버전** | 2.0.0 (SSOT 통합 버전) |
| **작성일** | 2025년 1월 |
| **작성자** | 개발팀 |
| **참고 문서** | service list.md, PROJECT_OVERVIEW.md, HABITREE_데이터구조_메뉴구조_분석서.md |

---

## 1. 개요

### 1.1 프로젝트 목적
Habitree는 개인의 독서 여정을 체계적으로 기록하고 관리하는 웹 애플리케이션입니다. 사용자가 읽은 책을 기록하고, 감동적인 문장을 필사로 남기며, 독서 통계를 확인할 수 있는 플랫폼을 제공합니다.

### 1.2 주요 목표
- 독서 기록의 체계적 관리
- 필사를 통한 인상적인 구절 보존
- 독서 패턴 분석 및 통계 제공
- 독서 커뮤니티 형성 지원

### 1.3 기술 스택
- **Frontend**: React 19.1.0, Vite 6.3.5, Tailwind CSS 4.1.10
- **Backend**: Firebase (Firestore, Storage, Authentication, Cloud Functions)
- **Routing**: React Router DOM 7.6.2
- **Search**: Fuse.js 7.1.0
- **Editor**: EditorJS

---

## 2. 사용자 인증 및 계정 관리

### 2.1 로그인 기능

#### 2.1.1 카카오 OAuth 2.0 로그인
**기능 설명**: 카카오 계정을 이용한 소셜 로그인 기능

**입력 항목**:
- 카카오 계정 정보 (카카오에서 제공)

**처리 과정**:
1. 사용자가 "카카오 로그인" 버튼 클릭
2. 카카오 인증 페이지로 리다이렉트
3. 사용자 인증 후 콜백 URL로 인가 코드 전달
4. 인가 코드로 액세스 토큰 요청
5. 액세스 토큰으로 사용자 정보 요청
6. Firebase Authentication에 사용자 정보 저장
7. 메인 페이지로 리다이렉트

**출력 항목**:
- 로그인 상태 업데이트
- 사용자 프로필 정보 표시

**에러 처리**:
- 인증 실패 시 에러 메시지 표시
- 네트워크 오류 시 재시도 안내

**권한**: 공개 (모든 사용자)

---

#### 2.1.2 이메일/비밀번호 로그인
**기능 설명**: 이메일과 비밀번호를 이용한 로그인 기능

**입력 항목**:
- 이메일 주소 (필수, 이메일 형식 검증)
- 비밀번호 (필수, 최소 6자)

**처리 과정**:
1. 사용자가 이메일과 비밀번호 입력
2. Firebase Authentication으로 인증 요청
3. 인증 성공 시 사용자 정보 로드
4. 로그인 상태 업데이트

**출력 항목**:
- 로그인 성공 시 메인 페이지로 이동
- 사용자 프로필 정보 표시

**에러 처리**:
- 잘못된 이메일/비밀번호: "이메일 또는 비밀번호가 올바르지 않습니다"
- 이메일 미인증: "이메일 인증이 필요합니다"
- 네트워크 오류: "네트워크 오류가 발생했습니다"

**권한**: 공개 (모든 사용자)

---

### 2.2 회원가입 기능

**기능 설명**: 새로운 사용자 계정 생성

**입력 항목**:
- 이메일 주소 (필수, 이메일 형식 검증, 중복 확인)
- 비밀번호 (필수, 최소 6자)
- 비밀번호 확인 (필수, 비밀번호와 일치 확인)
- 닉네임 (선택)
- 약관 동의 (필수)

**처리 과정**:
1. 입력 정보 유효성 검증
2. 이메일 중복 확인
3. Firebase Authentication으로 계정 생성
4. 이메일 인증 메일 발송
5. 사용자 프로필 정보 Firestore에 저장
6. 로그인 상태로 전환

**출력 항목**:
- 회원가입 성공 메시지
- 이메일 인증 안내 메시지
- 자동 로그인

**에러 처리**:
- 이메일 중복: "이미 사용 중인 이메일입니다"
- 약관 미동의: "약관에 동의해주세요"
- 비밀번호 불일치: "비밀번호가 일치하지 않습니다"

**권한**: 공개 (모든 사용자)

---

### 2.3 비밀번호 재설정

**기능 설명**: 비밀번호를 잊은 경우 재설정

**입력 항목**:
- 이메일 주소 (필수)

**처리 과정**:
1. 이메일 주소 입력
2. Firebase Cloud Functions로 비밀번호 재설정 링크 생성
3. 이메일로 재설정 링크 발송
4. 링크 클릭 시 비밀번호 변경 페이지로 이동
5. 새 비밀번호 입력 및 확인
6. 비밀번호 변경 완료

**출력 항목**:
- 이메일 발송 완료 메시지
- 비밀번호 변경 완료 메시지

**에러 처리**:
- 존재하지 않는 이메일: "등록되지 않은 이메일입니다"
- 링크 만료: "링크가 만료되었습니다"

**권한**: 공개 (모든 사용자)

---

### 2.4 사용자 프로필 관리

#### 2.4.1 프로필 조회
**기능 설명**: 현재 로그인한 사용자의 프로필 정보 조회

**데이터 소스**: 
- Firebase Authentication (이메일, 프로필 이미지)
- Firestore `users/{userId}/profile` (추가 정보)

**출력 항목**:
- 닉네임
- 이메일
- 프로필 이미지
- 가입일
- 마지막 로그인 시간

**권한**: 로그인 사용자 (본인만)

---

#### 2.4.2 프로필 수정
**기능 설명**: 사용자 프로필 정보 수정

**입력 항목**:
- 닉네임 (선택, 최대 20자)
- 프로필 이미지 (선택, 이미지 파일)

**처리 과정**:
1. 수정할 정보 입력
2. 프로필 이미지 업로드 (선택)
3. Firestore에 업데이트
4. 변경사항 즉시 반영

**출력 항목**:
- 수정 완료 메시지
- 업데이트된 프로필 정보

**에러 처리**:
- 이미지 업로드 실패: "이미지 업로드에 실패했습니다"
- 네트워크 오류: "네트워크 오류가 발생했습니다"

**권한**: 로그인 사용자 (본인만)

---

### 2.5 로그아웃

**기능 설명**: 현재 세션 종료

**처리 과정**:
1. Firebase Authentication 로그아웃
2. 로컬 스토리지 데이터 삭제
3. 로그인 페이지로 리다이렉트

**출력 항목**:
- 로그아웃 완료 메시지

**권한**: 로그인 사용자

---

## 3. 책 검색 및 등록

### 3.1 책 검색 기능

#### 3.1.1 ISBN 검색
**기능 설명**: ISBN 번호로 책 정보 검색

**입력 항목**:
- ISBN 번호 (필수, 10자리 또는 13자리)

**처리 과정**:
1. ISBN 번호 입력
2. Naver Books API 호출
3. 검색 결과 파싱
4. 책 정보 표시

**출력 항목**:
- 책 제목
- 저자
- 출판사
- 출판일
- 책 표지 이미지
- ISBN
- 책 소개

**에러 처리**:
- 잘못된 ISBN: "올바른 ISBN 번호를 입력해주세요"
- 검색 결과 없음: "검색 결과가 없습니다"
- API 오류: "검색 중 오류가 발생했습니다"

**권한**: 공개 (모든 사용자)

---

#### 3.1.2 제목/저자 검색
**기능 설명**: 키워드로 책 검색

**입력 항목**:
- 검색 키워드 (필수, 최소 1자)

**처리 과정**:
1. 검색 키워드 입력
2. Naver Books API 호출
3. 검색 결과 목록 표시
4. 페이지네이션 처리

**출력 항목**:
- 검색 결과 목록 (최대 100개)
- 각 결과: 제목, 저자, 출판사, 표지 이미지

**정렬 옵션**:
- 정확도순 (기본)
- 출판일순
- 판매량순

**권한**: 공개 (모든 사용자)

---

#### 3.1.3 샘플 책 조회
**기능 설명**: Firebase에 저장된 샘플 책 목록 조회

**데이터 소스**: 
- Firestore `sample_books` 컬렉션
- 또는 n8n 웹훅 (레거시)

**출력 항목**:
- 샘플 책 목록
- 각 책의 기본 정보

**필터링**:
- 전체
- 읽는 중
- 완독
- 읽지 않음

**권한**: 공개 (모든 사용자)

---

### 3.2 책 등록 기능

#### 3.2.1 검색 결과에서 등록
**기능 설명**: 검색 결과에서 선택한 책을 내 책 목록에 등록

**입력 항목**:
- 독서 상태 (필수): 읽는 중, 완독, 읽지 않음, 재독, 탐독, 필사 중
- 독서 카테고리 (선택): 종이책, 전자책, 오디오북, 종이책+전자책
- 읽는 이유 (선택)
- 별점 (선택): 1-5점
- 상세 소개 (선택)

**처리 과정**:
1. 검색 결과에서 책 선택
2. 책 정보 자동 입력
3. 추가 정보 입력 (선택)
4. Firestore `users/{userId}/books/{bookId}`에 저장
5. 등록 완료 메시지 표시

**출력 항목**:
- 등록 완료 메시지
- 내 책 목록에 추가됨

**에러 처리**:
- 중복 등록: "이미 등록된 책입니다"
- 저장 실패: "책 등록에 실패했습니다"

**권한**: 로그인 사용자

---

#### 3.2.2 수동 책 등록
**기능 설명**: 검색 없이 직접 책 정보 입력하여 등록

**입력 항목**:
- 책 제목 (필수)
- 저자 (필수)
- 출판사 (선택)
- ISBN (선택)
- 책 표지 이미지 (선택)
- 독서 상태 (필수)
- 독서 카테고리 (선택)
- 읽는 이유 (선택)
- 별점 (선택)
- 상세 소개 (선택)

**처리 과정**:
1. 책 정보 입력 폼 표시
2. 필수 정보 입력
3. 선택 정보 입력
4. 책 표지 이미지 업로드 (선택)
5. Firestore에 저장

**출력 항목**:
- 등록 완료 메시지

**권한**: 로그인 사용자

---

### 3.3 책 정보 수정

**기능 설명**: 등록된 책의 정보 수정

**입력 항목**:
- 수정 가능한 모든 필드

**처리 과정**:
1. 책 정보 수정 모달 열기
2. 수정할 정보 입력
3. Firestore 업데이트
4. 변경사항 즉시 반영

**출력 항목**:
- 수정 완료 메시지

**권한**: 로그인 사용자 (본인이 등록한 책만)

---

### 3.4 책 삭제

**기능 설명**: 등록된 책 삭제

**처리 과정**:
1. 삭제 확인 다이얼로그 표시
2. 확인 시 Firestore에서 삭제
3. 관련 필사 데이터는 유지 (선택적으로 삭제 가능)

**출력 항목**:
- 삭제 완료 메시지

**권한**: 로그인 사용자 (본인이 등록한 책만)

---

## 4. 필사 관리

### 4.1 필사 등록

#### 4.1.1 이미지 업로드 및 OCR
**기능 설명**: 책 페이지 이미지를 업로드하고 OCR로 텍스트 추출

**입력 항목**:
- 이미지 파일 (필수, jpg, png, 최대 10MB)
- 책 선택 (필수, 등록된 책 중 선택)
- 페이지 번호 (선택)

**처리 과정**:
1. 이미지 파일 선택
2. Firebase Storage에 업로드
3. Firebase Cloud Functions의 OCR 함수 호출
4. Google Vision API로 텍스트 추출
5. 추출된 텍스트 표시 및 편집 가능

**출력 항목**:
- 업로드된 이미지 미리보기
- 추출된 텍스트 (편집 가능)

**에러 처리**:
- 파일 크기 초과: "파일 크기는 10MB 이하여야 합니다"
- 지원하지 않는 형식: "jpg, png 파일만 업로드 가능합니다"
- OCR 실패: "텍스트 추출에 실패했습니다. 다시 시도해주세요"

**권한**: 로그인 사용자

---

#### 4.1.2 필사 정보 입력
**기능 설명**: 필사 제목, 내용 등 정보 입력

**입력 항목**:
- 필사 제목 (필수, 최대 100자)
- 필사 내용 (필수, OCR 텍스트 또는 직접 입력)
- 페이지 번호 (선택)
- 필사 날짜 (선택, 기본값: 오늘)

**처리 과정**:
1. 필사 정보 입력 폼 표시
2. 필수 정보 입력
3. Firestore `transcriptions` 컬렉션에 저장
4. 이미지는 Firebase Storage에 저장
5. 등록 완료

**출력 항목**:
- 등록 완료 메시지
- 필사 목록에 추가됨

**데이터 구조**:
```javascript
{
  id: "문서ID",
  userId: "사용자ID",
  bookId: "책ID",
  bookTitle: "책제목",
  bookAuthor: "저자",
  title: "필사제목",
  content: "필사내용",
  fullText: "OCR전체텍스트",
  page: "페이지번호",
  date: "필사날짜",
  imageUrl: "이미지URL",
  imagePath: "Storage경로",
  createdAt: "생성일시",
  updatedAt: "수정일시"
}
```

**권한**: 로그인 사용자

---

### 4.2 필사 조회

#### 4.2.1 내 필사 목록 조회
**기능 설명**: 사용자가 등록한 필사 목록 조회

**데이터 소스**: 
- Firestore `transcriptions` 컬렉션 (userId로 필터링)

**출력 항목**:
- 필사 목록 (카드 또는 리스트 형태)
- 각 필사: 제목, 책 제목, 날짜, 썸네일 이미지

**정렬 옵션**:
- 최신순 (기본)
- 오래된순
- 책 제목순
- 필사 제목순

**필터링**:
- 전체
- 책별 필터링
- 날짜별 필터링

**권한**: 로그인 사용자 (본인 필사만)

---

#### 4.2.2 책별 필사 조회
**기능 설명**: 특정 책에 대한 필사 목록 조회

**입력 항목**:
- 책 ID (URL 파라미터)

**출력 항목**:
- 해당 책의 필사 목록
- 책 정보 (제목, 저자, 표지)

**권한**: 로그인 사용자 (본인이 등록한 책의 필사만)

---

#### 4.2.3 필사 상세 조회
**기능 설명**: 개별 필사의 상세 정보 조회

**입력 항목**:
- 필사 ID (URL 파라미터 또는 모달)

**출력 항목**:
- 필사 이미지 (전체 크기)
- 필사 제목
- 필사 내용
- 책 정보 (제목, 저자, 표지)
- 페이지 번호
- 필사 날짜
- 생성일/수정일

**권한**: 로그인 사용자 (본인 필사만)

---

### 4.3 필사 수정

**기능 설명**: 등록된 필사 정보 수정

**입력 항목**:
- 수정 가능한 모든 필드 (제목, 내용, 페이지, 날짜)
- 이미지 교체 (선택)

**처리 과정**:
1. 필사 수정 모달 열기
2. 수정할 정보 입력
3. 이미지 교체 시 새 이미지 업로드
4. Firestore 업데이트
5. 변경사항 즉시 반영

**출력 항목**:
- 수정 완료 메시지

**권한**: 로그인 사용자 (본인 필사만)

---

### 4.4 필사 삭제

**기능 설명**: 등록된 필사 삭제

**처리 과정**:
1. 삭제 확인 다이얼로그 표시
2. 확인 시 Firestore에서 삭제
3. Firebase Storage에서 이미지 삭제
4. 삭제 완료

**출력 항목**:
- 삭제 완료 메시지

**권한**: 로그인 사용자 (본인 필사만)

---

### 4.5 필사 공유

#### 4.5.1 공유 링크 생성
**기능 설명**: 필사를 공유할 수 있는 링크 생성

**처리 과정**:
1. 필사 상세 페이지에서 "공유하기" 버튼 클릭
2. Firestore `shared_links` 컬렉션에 공유 정보 저장
3. 공유 링크 URL 생성: `/shared/{linkId}`
4. 링크 복사 기능 제공

**출력 항목**:
- 공유 링크 URL
- 링크 복사 버튼
- 만료 시간 안내 (30일)

**데이터 구조**:
```javascript
{
  id: "링크ID",
  bookId: "책ID",
  bookTitle: "책제목",
  bookCoverUrl: "책표지URL",
  transcriptionId: "필사ID",
  transcriptionTitle: "필사제목",
  transcriptionImageUrl: "필사이미지URL",
  transcriptionContent: "필사내용",
  transcriptionDate: "필사날짜",
  transcriptionPage: "페이지번호",
  createdAt: "생성시간",
  expiresAt: "만료시간 (30일 후)",
  userId: "생성한사용자ID"
}
```

**권한**: 로그인 사용자 (본인 필사만)

---

#### 4.5.2 공유 링크 조회
**기능 설명**: 공유 링크를 통해 필사 조회 (로그인 불필요)

**입력 항목**:
- 링크 ID (URL 파라미터)

**처리 과정**:
1. 링크 ID로 `shared_links` 컬렉션 조회
2. 만료 시간 확인
3. 만료되지 않았으면 필사 정보 표시
4. 만료되었으면 만료 메시지 표시

**출력 항목**:
- 책 표지 이미지
- 책 제목, 저자
- 필사 이미지
- 필사 제목, 내용
- 필사 날짜, 페이지

**에러 처리**:
- 링크 없음: "존재하지 않는 링크입니다"
- 링크 만료: "만료된 링크입니다"

**권한**: 공개 (모든 사용자)

---

### 4.6 샘플 필사 관리 (관리자)

#### 4.6.1 샘플 필사 등록
**기능 설명**: 관리자가 샘플 필사 등록

**입력 항목**:
- 필사 제목 (필수)
- 필사 내용 (필수)
- 책 제목 (필수)
- 책 저자 (필수)
- 이미지 (필수)
- 날짜 (선택)

**처리 과정**:
1. 관리자 권한 확인
2. 샘플 필사 등록 폼 표시
3. 정보 입력 및 이미지 업로드
4. Firestore `sample_transcriptions` 또는 `transcriptions` (userId: null)에 저장

**출력 항목**:
- 등록 완료 메시지

**권한**: 관리자만

---

#### 4.6.2 샘플 필사 조회
**기능 설명**: 샘플 필사 목록 조회

**데이터 소스**: 
- Firestore `sample_transcriptions` 또는 `transcriptions` (userId: null)

**출력 항목**:
- 샘플 필사 목록

**권한**: 공개 (모든 사용자)

---

## 5. 독서 기록 관리

### 5.1 내 책 목록 조회

**기능 설명**: 사용자가 등록한 책 목록 조회

**데이터 소스**: 
- Firestore `users/{userId}/books`

**출력 항목**:
- 책 목록 (카드 또는 테이블 형태)
- 각 책: 표지, 제목, 저자, 독서 상태, 등록일

**정렬 옵션**:
- 등록일순 (기본)
- 수정일순
- 제목순
- 저자순

**필터링**:
- 전체
- 읽는 중
- 완독
- 읽지 않음
- 재독
- 탐독
- 필사 중

**검색**:
- 제목 검색
- 저자 검색

**권한**: 로그인 사용자 (본인 책만)

---

### 5.2 책 상세 정보 조회

**기능 설명**: 등록된 책의 상세 정보 조회

**입력 항목**:
- 책 ID (URL 파라미터)

**출력 항목**:
- 책 기본 정보 (제목, 저자, 출판사, ISBN, 표지)
- 독서 상태
- 독서 카테고리
- 별점
- 읽는 이유
- 상세 소개
- 등록일/수정일
- 관련 필사 목록

**권한**: 로그인 사용자 (본인이 등록한 책만)

---

### 5.3 독서 상태 변경

**기능 설명**: 책의 독서 상태 변경

**입력 항목**:
- 독서 상태 (읽는 중, 완독, 읽지 않음, 재독, 탐독, 필사 중)

**처리 과정**:
1. 독서 상태 선택
2. Firestore 업데이트
3. 변경사항 즉시 반영

**출력 항목**:
- 상태 변경 완료 메시지

**권한**: 로그인 사용자 (본인이 등록한 책만)

---

### 5.4 독서 평가 작성

**기능 설명**: 책에 대한 별점 및 서평 작성

**입력 항목**:
- 별점 (1-5점, 선택)
- 서평 (선택)
- 상세 소개 (선택)

**처리 과정**:
1. 평가 정보 입력
2. Firestore 업데이트
3. 변경사항 즉시 반영

**출력 항목**:
- 평가 저장 완료 메시지

**권한**: 로그인 사용자 (본인이 등록한 책만)

---

## 6. 그룹 관리

### 6.1 그룹 생성

**기능 설명**: 새로운 독서 그룹 생성

**입력 항목**:
- 그룹명 (필수, 최대 50자)
- 그룹 설명 (선택, 최대 500자)
- 그룹 이미지 (선택)

**처리 과정**:
1. 그룹 정보 입력
2. Firestore `groups` 컬렉션에 저장
3. 생성자를 그룹 관리자로 설정
4. 생성자를 그룹 멤버로 추가

**출력 항목**:
- 그룹 생성 완료 메시지
- 그룹 상세 페이지로 이동

**데이터 구조**:
```javascript
{
  id: "그룹ID",
  name: "그룹명",
  description: "그룹설명",
  members: ["사용자ID1", "사용자ID2"],
  adminId: "관리자ID",
  createdAt: "생성시간"
}
```

**권한**: 로그인 사용자

---

### 6.2 그룹 목록 조회

**기능 설명**: 참여 중인 그룹 목록 조회

**데이터 소스**: 
- Firestore `groups` 컬렉션 (members 배열에 현재 사용자 ID 포함)

**출력 항목**:
- 그룹 목록
- 각 그룹: 그룹명, 설명, 멤버 수, 생성일

**권한**: 로그인 사용자

---

### 6.3 그룹 상세 정보

**기능 설명**: 그룹의 상세 정보 조회

**입력 항목**:
- 그룹 ID (URL 파라미터)

**출력 항목**:
- 그룹 기본 정보 (이름, 설명, 이미지)
- 멤버 목록
- 그룹 활동 내역
- 그룹 일정

**권한**: 로그인 사용자 (그룹 멤버만)

---

### 6.4 그룹 멤버 관리

#### 6.4.1 멤버 초대
**기능 설명**: 그룹에 새 멤버 초대

**입력 항목**:
- 초대할 사용자 이메일 또는 사용자 ID

**처리 과정**:
1. 초대할 사용자 정보 입력
2. 사용자 존재 확인
3. 그룹 멤버 목록에 추가
4. 초대 완료

**출력 항목**:
- 초대 완료 메시지

**권한**: 그룹 관리자

---

#### 6.4.2 멤버 제거
**기능 설명**: 그룹에서 멤버 제거

**처리 과정**:
1. 제거할 멤버 선택
2. 확인 다이얼로그 표시
3. 확인 시 그룹 멤버 목록에서 제거

**출력 항목**:
- 제거 완료 메시지

**권한**: 그룹 관리자

---

### 6.5 그룹 일정 관리

#### 6.5.1 일정 등록
**기능 설명**: 그룹 독서 일정 등록

**입력 항목**:
- 일정 제목 (필수)
- 일정 설명 (선택)
- 시작일 (필수)
- 종료일 (선택)
- 관련 책 (선택)

**처리 과정**:
1. 일정 정보 입력
2. Firestore에 저장
3. 그룹 일정 목록에 추가

**출력 항목**:
- 일정 등록 완료 메시지

**권한**: 그룹 관리자

---

#### 6.5.2 일정 조회
**기능 설명**: 그룹 일정 목록 조회

**출력 항목**:
- 일정 목록
- 각 일정: 제목, 설명, 기간, 관련 책

**정렬 옵션**:
- 시작일순
- 등록일순

**권한**: 그룹 멤버

---

### 6.6 그룹 관리자 기능

#### 6.6.1 그룹 설정 변경
**기능 설명**: 그룹 정보 수정

**입력 항목**:
- 그룹명
- 그룹 설명
- 그룹 이미지

**권한**: 그룹 관리자

---

#### 6.6.2 그룹 삭제
**기능 설명**: 그룹 삭제

**처리 과정**:
1. 삭제 확인 다이얼로그 표시
2. 확인 시 그룹 삭제
3. 관련 데이터 정리

**권한**: 그룹 관리자

---

## 7. 검색 및 필터링

### 7.1 통합 검색

**기능 설명**: 책과 필사를 통합 검색

**입력 항목**:
- 검색 키워드 (필수)

**처리 과정**:
1. 검색 키워드 입력
2. Firestore에서 책과 필사 동시 검색
3. 검색 결과 통합 표시

**출력 항목**:
- 책 검색 결과
- 필사 검색 결과

**권한**: 로그인 사용자 (본인 데이터만)

---

### 7.2 고급 필터링

**기능 설명**: 다양한 조건으로 데이터 필터링

**필터 옵션**:
- 독서 상태
- 독서 카테고리
- 날짜 범위
- 별점 범위
- 책 제목/저자
- 필사 제목/내용

**출력 항목**:
- 필터링된 결과 목록

**권한**: 로그인 사용자

---

## 8. 관리자 기능

### 8.1 관리자 대시보드

**기능 설명**: 시스템 전체 통계 및 상태 조회

**출력 항목**:
- 전체 사용자 수
- 전체 책 등록 수
- 전체 필사 수
- 일일/월일 활동 통계
- 시스템 상태

**권한**: 관리자만

---

### 8.2 사용자 관리

**기능 설명**: 사용자 정보 조회 및 관리

**기능**:
- 사용자 목록 조회
- 사용자 상세 정보 조회
- 사용자 권한 변경
- 사용자 계정 정지/해제

**권한**: 관리자만

---

### 8.3 데이터 관리

**기능 설명**: 시스템 데이터 관리

**기능**:
- 샘플 책 관리
- 샘플 필사 관리
- 데이터 마이그레이션
- 데이터 백업/복원

**권한**: 관리자만

---

### 8.4 시스템 설정

**기능 설명**: 시스템 설정 관리

**기능**:
- Firebase 설정 확인
- 보안 규칙 관리
- 외부 API 설정
- 알림 설정

**권한**: 관리자만

---

## 9. 외부 연동

### 9.1 Notion 연동

**기능 설명**: Notion API를 통한 데이터 동기화

**기능**:
- 독서 기록 Notion 페이지 생성
- 필사 Notion 페이지 생성
- 데이터 자동 동기화

**권한**: 로그인 사용자 (설정 필요)

---

### 9.2 Google Sheets 연동

**기능 설명**: Google Sheets API를 통한 데이터 내보내기/가져오기

**기능**:
- 독서 기록 내보내기
- 필사 내보내기
- 데이터 가져오기

**권한**: 로그인 사용자 (설정 필요)

---

### 9.3 n8n 웹훅

**기능 설명**: n8n 웹훅을 통한 자동화

**기능**:
- 데이터 자동 처리
- 워크플로우 실행
- 외부 시스템 연동

**권한**: 시스템 (자동)

---

## 10. UI/UX 기능

### 10.1 반응형 디자인

**기능 설명**: 다양한 화면 크기에 대응

**지원 화면**:
- 모바일 (320px 이상)
- 태블릿 (768px 이상)
- 데스크톱 (1024px 이상)
- 와이드 스크린 (1920px 이상)

**특징**:
- 모바일: 카드 형태 레이아웃
- 데스크톱: 테이블 형태 레이아웃
- 자동 레이아웃 전환

---

### 10.2 모바일 네비게이션

**기능 설명**: 모바일 환경을 위한 네비게이션

**기능**:
- 하단 네비게이션 바
- 햄버거 메뉴
- 터치 제스처 지원

---

### 10.3 리치 에디터

**기능 설명**: EditorJS 기반 리치 텍스트 에디터

**지원 기능**:
- 헤더 (H1-H6)
- 리스트 (순서 있음/없음)
- 인용구
- 강조 표시
- 코드 블록
- 테이블
- 링크
- 이미지 삽입
- 체크리스트

**사용 위치**:
- 필사 내용 편집
- 서평 작성
- 그룹 설명 작성

---

### 10.4 모달 및 다이얼로그

**기능 설명**: 다양한 모달 및 다이얼로그

**종류**:
- 책 정보 편집 모달
- 필사 등록/수정 모달
- 필사 상세 보기 모달
- 확인 다이얼로그
- 에러 다이얼로그

---

### 10.5 로딩 및 피드백

**기능 설명**: 사용자 피드백 제공

**기능**:
- 로딩 스피너
- 진행률 표시
- 성공 메시지
- 에러 메시지
- 토스트 알림

---

## 11. 보안 및 권한

### 11.1 데이터 접근 제어

**규칙**:
- 사용자는 본인의 데이터만 접근 가능
- 공개 필사는 모든 사용자가 조회 가능
- 그룹 멤버는 그룹 데이터 접근 가능
- 관리자는 모든 데이터 접근 가능

**구현**:
- Firestore Security Rules
- Storage Security Rules
- 클라이언트 측 권한 검증

---

### 11.2 파일 업로드 보안

**제한사항**:
- 파일 타입: jpg, png만 허용
- 파일 크기: 최대 10MB
- 이미지 검증

**처리**:
- 파일 타입 검증
- 파일 크기 검증
- 이미지 최적화
- 악성 파일 검사

---

### 11.3 인증 보안

**기능**:
- 토큰 기반 인증
- 세션 관리
- 자동 로그아웃 (일정 시간 미사용 시)
- 비밀번호 암호화

---

## 12. 성능 최적화

### 12.1 데이터 로딩

**기능**:
- 지연 로딩 (Lazy Loading)
- 페이지네이션
- 데이터 캐싱
- 프리페칭

---

### 12.2 이미지 최적화

**기능**:
- 이미지 리사이징
- 이미지 압축
- 지연 로딩
- WebP 형식 지원

---

### 12.3 코드 최적화

**기능**:
- 코드 스플리팅
- 번들 최적화
- 트리 쉐이킹
- 불필요한 리렌더링 방지

---

## 13. 에러 처리

### 13.1 일반 에러 처리

**에러 유형**:
- 네트워크 오류
- 인증 오류
- 권한 오류
- 데이터 검증 오류
- 서버 오류

**처리 방법**:
- 사용자 친화적 에러 메시지
- 에러 로깅
- 자동 재시도 (일부 경우)
- 에러 리포트

---

### 13.2 특정 에러 시나리오

#### 13.2.1 로그인 실패
- "이메일 또는 비밀번호가 올바르지 않습니다"
- "계정이 비활성화되었습니다"
- "네트워크 오류가 발생했습니다"

#### 13.2.2 데이터 저장 실패
- "데이터 저장에 실패했습니다. 다시 시도해주세요"
- "권한이 없습니다"
- "네트워크 오류가 발생했습니다"

#### 13.2.3 파일 업로드 실패
- "파일 업로드에 실패했습니다"
- "파일 크기가 너무 큽니다"
- "지원하지 않는 파일 형식입니다"

---

## 14. 데이터 구조

### 14.1 Firestore 컬렉션 구조

```
Firebase Project: habitree-f49e1
├── users/{userId}/
│   ├── books/{bookId}
│   ├── transcriptions/{id}
│   └── profile
├── transcriptions/ (SSOT)
├── sample_transcriptions/
├── groups/
├── shared_links/
└── policy_capability/
```

---

### 14.2 Storage 구조

```
Firebase Storage
├── write/ (샘플 필사 이미지)
└── users/{userId}/
    ├── transcriptions/ (사용자 필사 이미지)
    └── user_uploads/ (사용자 업로드 파일)
```

---

## 15. API 명세

### 15.1 Firebase Cloud Functions

#### 15.1.1 extractTextFromImage
**기능**: 이미지에서 텍스트 추출 (OCR)

**입력**:
- imageUrl: 이미지 URL
- userId: 사용자 ID

**출력**:
- text: 추출된 텍스트
- confidence: 신뢰도

---

#### 15.1.2 sendPasswordResetEmail
**기능**: 비밀번호 재설정 이메일 발송

**입력**:
- email: 이메일 주소

**출력**:
- success: 성공 여부
- resetLink: 재설정 링크

---

### 15.2 외부 API

#### 15.2.1 Naver Books API
**기능**: 책 정보 검색

**엔드포인트**: `https://openapi.naver.com/v1/search/book.json`

**입력**:
- query: 검색 키워드
- display: 결과 개수
- start: 시작 위치

**출력**:
- 책 정보 배열

---

#### 15.2.2 Google Vision API
**기능**: 이미지 텍스트 추출

**엔드포인트**: `https://vision.googleapis.com/v1/images:annotate`

**입력**:
- image: 이미지 데이터
- features: 요청 기능

**출력**:
- textAnnotations: 추출된 텍스트

---

## 16. 테스트 및 디버깅

### 16.1 테스트 기능

**기능**:
- Firebase 설정 테스트
- 인증 테스트
- 데이터 접근 테스트
- 권한 테스트

**접근 경로**:
- `/firebase-test`: Firebase 설정 테스트
- `/auth-debug`: 인증 디버그
- `/debug`: Firebase 디버그 패널

**권한**: 관리자만

---

### 16.2 디버깅 도구

**기능**:
- 로그인 상태 확인
- 데이터 구조 확인
- 권한 확인
- 네트워크 요청 모니터링

---

## 17. 향후 계획 기능

### 17.1 독서 통계 대시보드
- 읽은 책 수 통계
- 독서 패턴 분석
- 장르별 분포
- 월별/연도별 통계

### 17.2 AI 기반 추천
- 책 추천
- 필사 추천
- 독서 패턴 기반 추천

### 17.3 커뮤니티 기능
- 독서 모임
- 서평 공유
- 독서 챌린지

### 17.4 알림 기능
- 독서 알림
- 그룹 활동 알림
- 시스템 알림

---

## 18. 부록

### 18.1 용어 정의

| 용어 | 설명 |
|------|------|
| 필사 | 책의 인상적인 구절을 이미지로 촬영하고 텍스트로 추출하여 저장하는 기능 |
| SSOT | Single Source of Truth, 단일 데이터 소스 원칙 |
| OCR | Optical Character Recognition, 광학 문자 인식 |
| OAuth | Open Authorization, 개방형 인증 프로토콜 |

---

### 18.2 참고 문서
- service list.md: 서비스 기능 목록
- PROJECT_OVERVIEW.md: 프로젝트 개요
- HABITREE_데이터구조_메뉴구조_분석서.md: 데이터 구조 및 메뉴 구조 분석
- DATABASE_STRUCTURE.md: 데이터베이스 구조
- SYSTEM_ARCHITECTURE.md: 시스템 아키텍처

---

### 18.3 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0.0 | 2025-01 | 초기 기능명세서 작성 | 개발팀 |

---

**문서 끝**

